!function(a,b,c){function d(a){return"[object Function]"==q.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=r.shift();s=1,a?a.t?o(function(){("c"==a.t?m.injectCss:m.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):s=0}function i(a,c,d,e,f,i,j){function k(b){if(!n&&g(l.readyState)&&(t.r=n=1,!s&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&o(function(){v.removeChild(l)},50);for(var d in A[c])A[c].hasOwnProperty(d)&&A[c][d].onload()}}var j=j||m.errorTimeout,l={},n=0,q=0,t={t:d,s:c,e:f,a:i,x:j};1===A[c]&&(q=1,A[c]=[],l=b.createElement(a)),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,q)},r.splice(e,0,t),"img"!=a&&(q||2===A[c]?(v.insertBefore(l,u?null:p),o(k,j)):A[c].push(l))}function j(a,b,c,d,f){return s=0,b=b||"j",e(a)?i("c"==b?x:w,a,b,this.i++,c,d,f):(r.splice(this.i++,0,a),1==r.length&&h()),this}function k(){var a=m;return a.loader={load:j,i:0},a}var l,m,n=b.documentElement,o=a.setTimeout,p=b.getElementsByTagName("script")[0],q={}.toString,r=[],s=0,t="MozAppearance"in n.style,u=t&&!!b.createRange().compareNode,v=u?n:p.parentNode,n=a.opera&&"[object Opera]"==q.call(a.opera),n=!!b.attachEvent&&!n,w=t?"object":n?"script":"img",x=n?"script":w,y=Array.isArray||function(a){return"[object Array]"==q.call(a)},z=[],A={},B={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}};m=function(a){function b(a){var b,c,d,a=a.split("!"),e=z.length,f=a.pop(),g=a.length,f={url:f,origUrl:f,prefixes:a};for(c=0;g>c;c++)d=a[c].split("="),(b=B[d.shift()])&&(f=b(f,d));for(c=0;e>c;c++)f=z[c](f);return f}function g(a,e,f,g,i){var j=b(a),l=j.autoCallback;j.url.split(".").pop().split("?").shift(),j.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]||h),j.instead?j.instead(a,e,f,g,i):(A[j.url]?j.noexec=!0:A[j.url]=1,f.load(j.url,j.forceCSS||!j.forceJS&&"css"==j.url.split(".").pop().split("?").shift()?"c":c,j.noexec,j.attrs,j.timeout),(d(e)||d(l))&&f.load(function(){k(),e&&e(j.origUrl,i,g),l&&l(j.origUrl,i,g),A[j.url]=2})))}function i(a,b){function c(a,c){if(a){if(e(a))c||(l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}),g(a,l,b,0,j);else if(Object(a)===a)for(i in h=function(){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}(),a)a.hasOwnProperty(i)&&(!c&&!--h&&(d(l)?l=function(){var a=[].slice.call(arguments);m.apply(this,a),n()}:l[i]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),n()}}(m[i])),g(a[i],l,b,i,j))}else!c&&n()}var h,i,j=!!a.test,k=a.load||a.both,l=a.callback||f,m=l,n=a.complete||f;c(j?a.yep:a.nope,!!k),k&&c(k)}var j,l,n=this.yepnope.loader;if(e(a))g(a,0,n,0);else if(y(a))for(j=0;j<a.length;j++)l=a[j],e(l)?g(l,0,n,0):y(l)?m(l):Object(l)===l&&i(l,n);else Object(a)===a&&i(a,n)},m.addPrefix=function(a,b){B[a]=b},m.addFilter=function(a){z.push(a)},m.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",l=function(){b.removeEventListener("DOMContentLoaded",l,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k,l,n=b.createElement("script"),e=e||m.errorTimeout;n.src=a;for(l in d)n.setAttribute(l,d[l]);c=j?h:c||f,n.onreadystatechange=n.onload=function(){!k&&g(n.readyState)&&(k=1,c(),n.onload=n.onreadystatechange=null)},o(function(){k||(k=1,c(1))},e),i?n.onload():p.parentNode.insertBefore(n,p)},a.yepnope.injectCss=function(a,c,d,e,g,i){var j,e=b.createElement("link"),c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(p.parentNode.insertBefore(e,p),o(c,0))}}(this,document);var base64={};base64.PADCHAR="=",base64.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",base64.makeDOMException=function(){try{return new DOMException(DOMException.INVALID_CHARACTER_ERR)}catch(a){var b=new Error("DOM Exception 5");return b.code=b.number=5,b.name=b.description="INVALID_CHARACTER_ERR",b.toString=function(){return"Error: "+b.name+": "+b.message},b}},base64.getbyte64=function(a,b){var c=base64.ALPHA.indexOf(a.charAt(b));if(-1===c)throw base64.makeDOMException();return c},base64.decode=function(a){a=""+a;var b,c,d,e=base64.getbyte64,f=a.length;if(0===f)return a;if(0!==f%4)throw base64.makeDOMException();b=0,a.charAt(f-1)===base64.PADCHAR&&(b=1,a.charAt(f-2)===base64.PADCHAR&&(b=2),f-=4);var g=[];for(c=0;f>c;c+=4)d=e(a,c)<<18|e(a,c+1)<<12|e(a,c+2)<<6|e(a,c+3),g.push(String.fromCharCode(d>>16,255&d>>8,255&d));switch(b){case 1:d=e(a,c)<<18|e(a,c+1)<<12|e(a,c+2)<<6,g.push(String.fromCharCode(d>>16,255&d>>8));break;case 2:d=e(a,c)<<18|e(a,c+1)<<12,g.push(String.fromCharCode(d>>16))}return g.join("")},base64.getbyte=function(a,b){var c=a.charCodeAt(b);if(c>255)throw base64.makeDOMException();return c},base64.encode=function(a){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var b,c,d=base64.PADCHAR,e=base64.ALPHA,f=base64.getbyte,g=[];a=""+a;var h=a.length-a.length%3;if(0===a.length)return a;for(b=0;h>b;b+=3)c=f(a,b)<<16|f(a,b+1)<<8|f(a,b+2),g.push(e.charAt(c>>18)),g.push(e.charAt(63&c>>12)),g.push(e.charAt(63&c>>6)),g.push(e.charAt(63&c));switch(a.length-h){case 1:c=f(a,b)<<16,g.push(e.charAt(c>>18)+e.charAt(63&c>>12)+d+d);break;case 2:c=f(a,b)<<16|f(a,b+1)<<8,g.push(e.charAt(c>>18)+e.charAt(63&c>>12)+e.charAt(63&c>>6)+d)}return g.join("")},window.btoa||(window.btoa=base64.encode),function(a,b){function c(a){return!!(""===a||a&&a.charCodeAt&&a.substr)}function d(a){return l?l(a):"[object Array]"===m.call(a)}function e(a){return"[object Object]"===m.call(a)}function f(a,b){var c,a=a||{},b=b||{};for(c in b)b.hasOwnProperty(c)&&null==a[c]&&(a[c]=b[c]);return a}function g(a,b,c){var d,e,f=[];if(!a)return f;if(k&&a.map===k)return a.map(b,c);for(d=0,e=a.length;e>d;d++)f[d]=b.call(c,a[d],d,a);return f}function h(a,b){return a=Math.round(Math.abs(a)),isNaN(a)?b:a}function i(a){var b=j.settings.currency.format;return"function"==typeof a&&(a=a()),c(a)&&a.match("%v")?{pos:a,neg:a.replace("-","").replace("%v","-%v"),zero:a}:a&&a.pos&&a.pos.match("%v")?a:c(b)?j.settings.currency.format={pos:b,neg:b.replace("%v","-%v"),zero:b}:b}var j={version:"0.3.2",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}}},k=Array.prototype.map,l=Array.isArray,m=Object.prototype.toString,n=j.unformat=j.parse=function(a,b){if(d(a))return g(a,function(a){return n(a,b)});if(a=a||0,"number"==typeof a)return a;var b=b||".",c=RegExp("[^0-9-"+b+"]",["g"]),c=parseFloat((""+a).replace(/\((.*)\)/,"-$1").replace(c,"").replace(b,"."));return isNaN(c)?0:c},o=j.toFixed=function(a,b){var b=h(b,j.settings.number.precision),c=Math.pow(10,b);return(Math.round(j.unformat(a)*c)/c).toFixed(b)},p=j.formatNumber=function(a,b,c,i){if(d(a))return g(a,function(a){return p(a,b,c,i)});var a=n(a),k=f(e(b)?b:{precision:b,thousand:c,decimal:i},j.settings.number),l=h(k.precision),m=0>a?"-":"",q=parseInt(o(Math.abs(a||0),l),10)+"",r=3<q.length?q.length%3:0;return m+(r?q.substr(0,r)+k.thousand:"")+q.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+k.thousand)+(l?k.decimal+o(Math.abs(a),l).split(".")[1]:"")},q=j.formatMoney=function(a,b,c,k,l,m){if(d(a))return g(a,function(a){return q(a,b,c,k,l,m)});var a=n(a),o=f(e(b)?b:{symbol:b,precision:c,thousand:k,decimal:l,format:m},j.settings.currency),r=i(o.format);return(a>0?r.pos:0>a?r.neg:r.zero).replace("%s",o.symbol).replace("%v",p(Math.abs(a),h(o.precision),o.thousand,o.decimal))};j.formatColumn=function(a,b,k,l,m,o){if(!a)return[];var q=f(e(b)?b:{symbol:b,precision:k,thousand:l,decimal:m,format:o},j.settings.currency),r=i(q.format),s=r.pos.indexOf("%s")<r.pos.indexOf("%v")?!0:!1,t=0,a=g(a,function(a){return d(a)?j.formatColumn(a,q):(a=n(a),a=(a>0?r.pos:0>a?r.neg:r.zero).replace("%s",q.symbol).replace("%v",p(Math.abs(a),h(q.precision),q.thousand,q.decimal)),a.length>t&&(t=a.length),a)});return g(a,function(a){return c(a)&&a.length<t?s?a.replace(q.symbol,q.symbol+Array(t-a.length+1).join(" ")):Array(t-a.length+1).join(" ")+a:a})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports.accounting=j):"function"==typeof define&&define.amd?define([],function(){return j}):(j.noConflict=function(c){return function(){return a.accounting=c,j.noConflict=b,j}}(a.accounting),a.accounting=j)}(this),function(){function a(b,c,d){if(b===c)return 0!==b||1/b==1/c;if(null==b)return b===c;var e=typeof b;if(e!=typeof c)return!1;if(!b!=!c)return!1;if(x.isNaN(b))return x.isNaN(c);var f=x.isString(b),g=x.isString(c);if(f||g)return f&&g&&String(b)==String(c);var h=x.isNumber(b),i=x.isNumber(c);if(h||i)return h&&i&&+b==+c;var j=x.isBoolean(b),l=x.isBoolean(c);if(j||l)return j&&l&&+b==+c;var m=x.isDate(b),n=x.isDate(c);if(m||n)return m&&n&&b.getTime()==c.getTime();var o=x.isRegExp(b),p=x.isRegExp(c);if(o||p)return o&&p&&b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase;if("object"!=e)return!1;if(b._chain&&(b=b._wrapped),c._chain&&(c=c._wrapped),x.isFunction(b.isEqual))return b.isEqual(c);for(var q=d.length;q--;)if(d[q]==b)return!0;d.push(b);var r=0,s=!0;if(b.length===+b.length||c.length===+c.length){if(r=b.length,s=r==c.length)for(;r--&&(s=r in b==r in c&&a(b[r],c[r],d)););}else{for(var t in b)if(k.call(b,t)&&(r++,!(s=k.call(c,t)&&a(b[t],c[t],d))))break;if(s){for(t in c)if(k.call(c,t)&&!r--)break;s=!r}}return d.pop(),s}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=Function.prototype,h=e.slice,i=e.unshift,j=f.toString,k=f.hasOwnProperty,l=e.forEach,m=e.map,n=e.reduce,o=e.reduceRight,p=e.filter,q=e.every,r=e.some,s=e.indexOf,t=e.lastIndexOf,u=Array.isArray,v=Object.keys,w=g.bind,x=function(a){return new C(a)};"undefined"!=typeof module&&module.exports?(module.exports=x,x._=x):b._=x,x.VERSION="1.2.0";var y=x.each=x.forEach=function(a,b,c){if(null!=a)if(l&&a.forEach===l)a.forEach(b,c);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(e in a&&b.call(c,a[e],e,a)===d)return}else for(var g in a)if(k.call(a,g)&&b.call(c,a[g],g,a)===d)return};x.map=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=void 0!==c;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},x.reduceRight=x.foldr=function(a,b,c,d){if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),void 0!==c?a.reduceRight(b,c):a.reduceRight(b);var e=(x.isArray(a)?a.slice():x.toArray(a)).reverse();return x.reduce(e,b,c,d)},x.find=x.detect=function(a,b,c){var d;return z(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},x.reject=function(a,b,c){var d=[];return null==a?d:(y(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},x.every=x.all=function(a,b,c){var e=!0;return null==a?e:q&&a.every===q?a.every(b,c):(y(a,function(a,f,g){return(e=e&&b.call(c,a,f,g))?void 0:d}),e)};var z=x.some=x.any=function(a,b,c){b=b||x.identity;var e=!1;return null==a?e:r&&a.some===r?a.some(b,c):(y(a,function(a,f,g){return(e|=b.call(c,a,f,g))?d:void 0}),!!e)};x.include=x.contains=function(a,b){var c=!1;return null==a?c:s&&a.indexOf===s?-1!=a.indexOf(b):(z(a,function(a){return(c=a===b)?!0:void 0}),c)},x.invoke=function(a,b){var c=h.call(arguments,2);return x.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.max=function(a,b,c){if(!b&&x.isArray(a))return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a))return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=[];return y(a,function(a,d){0==d?c[0]=a:(b=Math.floor(Math.random()*(d+1)),c[d]=c[b],c[b]=a)}),c},x.sortBy=function(a,b,c){return x.pluck(x.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0}),"value")},x.groupBy=function(a,b){var c={};return y(a,function(a,d){var e=b(a,d);(c[e]||(c[e]=[])).push(a)}),c},x.sortedIndex=function(a,b,c){c||(c=x.identity);for(var d=0,e=a.length;e>d;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},x.toArray=function(a){return a?a.toArray?a.toArray():x.isArray(a)?h.call(a):x.isArguments(a)?h.call(a):x.values(a):[]},x.size=function(a){return x.toArray(a).length},x.first=x.head=function(a,b,c){return null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==b||c?a[a.length-1]:h.call(a,a.length-b)},x.rest=x.tail=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,function(a){return!!a})},x.flatten=function(a){return x.reduce(a,function(a,b){return x.isArray(b)?a.concat(x.flatten(b)):(a[a.length]=b,a)},[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c){var d=c?x.map(a,c):a,e=[];return x.reduce(d,function(c,d,f){return 0!=f&&(b===!0?x.last(c)==d:x.include(c,d))||(c[c.length]=d,e[e.length]=a[f]),c},[]),e},x.union=function(){return x.uniq(x.flatten(arguments))},x.intersection=x.intersect=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a,b){return x.filter(a,function(a){return!x.include(b,a)})},x.zip=function(){for(var a=h.call(arguments),b=x.max(x.pluck(a,"length")),c=new Array(b),d=0;b>d;d++)c[d]=x.pluck(a,""+d);return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d,e;if(c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;if(s&&a.indexOf===s)return a.indexOf(b);for(d=0,e=a.length;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b){if(null==a)return-1;if(t&&a.lastIndexOf===t)return a.lastIndexOf(b);for(var c=a.length;c--;)if(a[c]===b)return c;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f},x.bind=function(a,b){if(a.bind===w&&w)return w.apply(a,h.call(arguments,1));var c=h.call(arguments,2);return function(){return a.apply(b,c.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);return 0==b.length&&(b=x.functions(a)),y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return k.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))};var A=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),(c||!d)&&(d=setTimeout(g,b))}};x.throttle=function(a,b){return A(a,b,!1)},x.debounce=function(a,b){return A(a,b,!0)},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments))}},x.wrap=function(a,b){return function(){var c=[a].concat(h.call(arguments));return b.apply(this,c)}},x.compose=function(){var a=h.call(arguments);return function(){for(var b=h.call(arguments),c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)k.call(a,c)&&(b[b.length]=c);return b},x.values=function(a){return x.map(a,x.identity)},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){for(var c in b)void 0!==b[c]&&(a[c]=b[c])}),a},x.defaults=function(a){return y(h.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isArray(a)?a.slice():x.extend({},a)},x.tap=function(a,b){return b(a),a},x.isEqual=function(b,c){return a(b,c,[])},x.isEmpty=function(a){if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(k.call(a,b))return!1;return!0},x.isElement=function(a){return!!a&&1==a.nodeType},x.isArray=u||function(a){return"[object Array]"===j.call(a)},x.isObject=function(a){return a===Object(a)},x.isArguments=function(a){return!!a&&!!k.call(a,"callee")},x.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},x.isString=function(a){return!!(""===a||a&&a.charCodeAt&&a.substr)},x.isNumber=function(a){return!!(0===a||a&&a.toExponential&&a.toFixed)},x.isNaN=function(a){return a!==a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},x.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.noConflict=function(){return b._=c,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=0;a>d;d++)b.call(c,d)},x.escape=function(a){return(""+a).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},x.mixin=function(a){y(x.functions(a),function(b){E(b,x[b]=a[b])})};var B=0;x.uniqueId=function(a){var b=B++;return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},x.template=function(a,b){var c=x.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var C=function(a){this._wrapped=a};x.prototype=C.prototype;var D=function(a,b){return b?x(a).chain():a},E=function(a,b){C.prototype[a]=function(){var a=h.call(arguments);return i.call(a,this._wrapped),D(b.apply(x,a),this._chain)}};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];C.prototype[a]=function(){return b.apply(this._wrapped,arguments),D(this._wrapped,this._chain)}}),y(["concat","join","slice"],function(a){var b=e[a];C.prototype[a]=function(){return D(b.apply(this._wrapped,arguments),this._chain)}}),C.prototype.chain=function(){return this._chain=!0,this},C.prototype.value=function(){return this._wrapped}}();var Handlebars={};Handlebars.VERSION="1.0.beta.6",Handlebars.helpers={},Handlebars.partials={},Handlebars.registerHelper=function(a,b,c){c&&(b.not=c),this.helpers[a]=b},Handlebars.registerPartial=function(a,b){this.partials[a]=b},Handlebars.registerHelper("helperMissing",function(a){if(2===arguments.length)return void 0;throw new Error("Could not find property '"+a+"'")});var toString=Object.prototype.toString,functionType="[object Function]";Handlebars.registerHelper("blockHelperMissing",function(a,b){var c=b.inverse||function(){},d=b.fn,e="",f=toString.call(a);if(f===functionType&&(a=a.call(this)),a===!0)return d(this);if(a===!1||null==a)return c(this);if("[object Array]"===f){if(a.length>0)for(var g=0,h=a.length;h>g;g++)e+=d(a[g]);else e=c(this);return e}return d(a)}),Handlebars.registerHelper("each",function(a,b){var c=b.fn,d=b.inverse,e="";if(a&&a.length>0)for(var f=0,g=a.length;g>f;f++)e+=c(a[f]);else e=d(this);return e}),Handlebars.registerHelper("if",function(a,b){var c=toString.call(a);return c===functionType&&(a=a.call(this)),!a||Handlebars.Utils.isEmpty(a)?b.inverse(this):b.fn(this)}),Handlebars.registerHelper("unless",function(a,b){var c=b.fn,d=b.inverse;return b.fn=d,b.inverse=c,Handlebars.helpers["if"].call(this,a,b)}),Handlebars.registerHelper("with",function(a,b){return b.fn(a)}),Handlebars.registerHelper("log",function(a){Handlebars.log(a)});var handlebars=function(){var a={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,statements:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,params:25,hash:26,param:27,STRING:28,INTEGER:29,BOOLEAN:30,hashSegments:31,hashSegment:32,ID:33,EQUALS:34,pathSegments:35,SEP:36,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"STRING",29:"INTEGER",30:"BOOLEAN",33:"ID",34:"EQUALS",36:"SEP"},productions_:[0,[3,2],[4,3],[4,1],[4,0],[6,1],[6,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[7,2],[17,3],[17,2],[17,2],[17,1],[25,2],[25,1],[27,1],[27,1],[27,1],[27,1],[26,1],[31,2],[31,1],[32,3],[32,3],[32,3],[32,3],[21,1],[35,3],[35,1]],performAction:function(a,b,c,d,e,f){var g=f.length-1;switch(e){case 1:return f[g-1];case 2:this.$=new d.ProgramNode(f[g-2],f[g]);break;case 3:this.$=new d.ProgramNode(f[g]);break;case 4:this.$=new d.ProgramNode([]);break;case 5:this.$=[f[g]];break;case 6:f[g-1].push(f[g]),this.$=f[g-1];break;case 7:this.$=new d.InverseNode(f[g-2],f[g-1],f[g]);break;case 8:this.$=new d.BlockNode(f[g-2],f[g-1],f[g]);break;case 9:this.$=f[g];break;case 10:this.$=f[g];break;case 11:this.$=new d.ContentNode(f[g]);break;case 12:this.$=new d.CommentNode(f[g]);break;case 13:this.$=new d.MustacheNode(f[g-1][0],f[g-1][1]);break;case 14:this.$=new d.MustacheNode(f[g-1][0],f[g-1][1]);break;case 15:this.$=f[g-1];break;case 16:this.$=new d.MustacheNode(f[g-1][0],f[g-1][1]);break;case 17:this.$=new d.MustacheNode(f[g-1][0],f[g-1][1],!0);break;case 18:this.$=new d.PartialNode(f[g-1]);break;case 19:this.$=new d.PartialNode(f[g-2],f[g-1]);break;case 20:break;case 21:this.$=[[f[g-2]].concat(f[g-1]),f[g]];break;case 22:this.$=[[f[g-1]].concat(f[g]),null];break;case 23:this.$=[[f[g-1]],f[g]];break;case 24:this.$=[[f[g]],null];break;case 25:f[g-1].push(f[g]),this.$=f[g-1];break;case 26:this.$=[f[g]];break;case 27:this.$=f[g];break;case 28:this.$=new d.StringNode(f[g]);break;case 29:this.$=new d.IntegerNode(f[g]);break;case 30:this.$=new d.BooleanNode(f[g]);break;case 31:this.$=new d.HashNode(f[g]);break;case 32:f[g-1].push(f[g]),this.$=f[g-1];break;case 33:this.$=[f[g]];break;case 34:this.$=[f[g-2],f[g]];break;case 35:this.$=[f[g-2],new d.StringNode(f[g])];break;case 36:this.$=[f[g-2],new d.IntegerNode(f[g])];break;case 37:this.$=[f[g-2],new d.BooleanNode(f[g])];break;case 38:this.$=new d.IdNode(f[g]);break;case 39:f[g-2].push(f[g]),this.$=f[g-2];break;case 40:this.$=[f[g]]}},table:[{3:1,4:2,5:[2,4],6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{1:[3]},{5:[1,16]},{5:[2,3],7:17,8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,19],20:[2,3],22:[1,13],23:[1,14],24:[1,15]},{5:[2,5],14:[2,5],15:[2,5],16:[2,5],19:[2,5],20:[2,5],22:[2,5],23:[2,5],24:[2,5]},{4:20,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{4:21,6:3,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],24:[1,15]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{17:22,21:23,33:[1,25],35:24},{17:26,21:23,33:[1,25],35:24},{17:27,21:23,33:[1,25],35:24},{17:28,21:23,33:[1,25],35:24},{21:29,33:[1,25],35:24},{1:[2,1]},{6:30,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],24:[1,15]},{5:[2,6],14:[2,6],15:[2,6],16:[2,6],19:[2,6],20:[2,6],22:[2,6],23:[2,6],24:[2,6]},{17:22,18:[1,31],21:23,33:[1,25],35:24},{10:32,20:[1,33]},{10:34,20:[1,33]},{18:[1,35]},{18:[2,24],21:40,25:36,26:37,27:38,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,38],28:[2,38],29:[2,38],30:[2,38],33:[2,38],36:[1,46]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],36:[2,40]},{18:[1,47]},{18:[1,48]},{18:[1,49]},{18:[1,50],21:51,33:[1,25],35:24},{5:[2,2],8:18,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,2],22:[1,13],23:[1,14],24:[1,15]},{14:[2,20],15:[2,20],16:[2,20],19:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,7],14:[2,7],15:[2,7],16:[2,7],19:[2,7],20:[2,7],22:[2,7],23:[2,7],24:[2,7]},{21:52,33:[1,25],35:24},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{18:[2,22],21:40,26:53,27:54,28:[1,41],29:[1,42],30:[1,43],31:39,32:44,33:[1,45],35:24},{18:[2,23]},{18:[2,26],28:[2,26],29:[2,26],30:[2,26],33:[2,26]},{18:[2,31],32:55,33:[1,56]},{18:[2,27],28:[2,27],29:[2,27],30:[2,27],33:[2,27]},{18:[2,28],28:[2,28],29:[2,28],30:[2,28],33:[2,28]},{18:[2,29],28:[2,29],29:[2,29],30:[2,29],33:[2,29]},{18:[2,30],28:[2,30],29:[2,30],30:[2,30],33:[2,30]},{18:[2,33],33:[2,33]},{18:[2,40],28:[2,40],29:[2,40],30:[2,40],33:[2,40],34:[1,57],36:[2,40]},{33:[1,58]},{14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,17],14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]},{18:[1,59]},{18:[1,60]},{18:[2,21]},{18:[2,25],28:[2,25],29:[2,25],30:[2,25],33:[2,25]},{18:[2,32],33:[2,32]},{34:[1,57]},{21:61,28:[1,62],29:[1,63],30:[1,64],33:[1,25],35:24},{18:[2,39],28:[2,39],29:[2,39],30:[2,39],33:[2,39],36:[2,39]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{18:[2,34],33:[2,34]},{18:[2,35],33:[2,35]},{18:[2,36],33:[2,36]},{18:[2,37],33:[2,37]}],defaultActions:{16:[2,1],37:[2,23],53:[2,21]},parseError:function(a){throw new Error(a)},parse:function(a){function b(){var a;return a=c.lexer.lex()||1,"number"!=typeof a&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;f.push(l),"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var m,n,o,p,q,r,s,t,u,v={};;){if(o=d[d.length-1],this.defaultActions[o]?p=this.defaultActions[o]:(null==m&&(m=b()),p=g[o]&&g[o][m]),!("undefined"!=typeof p&&p.length&&p[0]||k)){u=[];for(r in g[o])this.terminals_[r]&&r>2&&u.push("'"+this.terminals_[r]+"'");var w="";w=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+u.join(", ")+", got '"+this.terminals_[m]+"'":"Parse error on line "+(i+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(w,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:l,expected:u})}if(p[0]instanceof Array&&p.length>1)throw new Error("Parse Error: multiple actions possible at state: "+o+", token: "+m);switch(p[0]){case 1:d.push(m),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(p[1]),m=null,n?(m=n,n=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,l=this.lexer.yylloc,k>0&&k--);break;case 2:if(s=this.productions_[p[1]][1],v.$=e[e.length-s],v._$={first_line:f[f.length-(s||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(s||1)].first_column,last_column:f[f.length-1].last_column},q=this.performAction.call(v,h,j,i,this.yy,p[1],e,f),"undefined"!=typeof q)return q;s&&(d=d.slice(0,2*-1*s),e=e.slice(0,-1*s),f=f.slice(0,-1*s)),d.push(this.productions_[p[1]][0]),e.push(v.$),f.push(v._$),t=g[d[d.length-2]][d[d.length-1]],d.push(t);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parseError)throw new Error(a);this.yy.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.match+=a,this.matched+=a;var b=a.match(/\n/);return b&&this.yylineno++,this._input=this._input.slice(1),a},unput:function(a){return this._input=a+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c;this._more||(this.yytext="",this.match="");for(var d=this._currentRules(),e=0;e<d.length;e++)if(b=this._input.match(this.rules[d[e]])){if(c=b[0].match(/\n.*/g),c&&(this.yylineno+=c.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-1:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,d[e],this.conditionStack[this.conditionStack.length-1]),a)return a;return}return""===this._input?this.EOF:(this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno}),void 0)},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.performAction=function(a,b,c,d){switch(c){case 0:if("\\"!==b.yytext.slice(-1)&&this.begin("mu"),"\\"===b.yytext.slice(-1)&&(b.yytext=b.yytext.substr(0,b.yyleng-1),this.begin("emu")),b.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return 24;case 4:return 16;case 5:return 20;case 6:return 19;case 7:return 19;case 8:return 23;case 9:return 23;case 10:return b.yytext=b.yytext.substr(3,b.yyleng-5),this.popState(),15;case 11:return 22;case 12:return 34;case 13:return 33;case 14:return 33;case 15:return 36;case 16:break;case 17:return this.popState(),18;case 18:return this.popState(),18;case 19:return b.yytext=b.yytext.substr(1,b.yyleng-2).replace(/\\"/g,'"'),28;
case 20:return 30;case 21:return 30;case 22:return 29;case 23:return 33;case 24:return b.yytext=b.yytext.substr(1,b.yyleng-2),33;case 25:return"INVALID";case 26:return 5}},a.rules=[/^[^\x00]*?(?=(\{\{))/,/^[^\x00]+/,/^[^\x00]{2,}?(?=(\{\{))/,/^\{\{>/,/^\{\{#/,/^\{\{\//,/^\{\{\^/,/^\{\{\s*else\b/,/^\{\{\{/,/^\{\{&/,/^\{\{![\s\S]*?\}\}/,/^\{\{/,/^=/,/^\.(?=[} ])/,/^\.\./,/^[\/.]/,/^\s+/,/^\}\}\}/,/^\}\}/,/^"(\\["]|[^"])*"/,/^true(?=[}\s])/,/^false(?=[}\s])/,/^[0-9]+(?=[}\s])/,/^[a-zA-Z0-9_$-]+(?=[=}\s\/.])/,/^\[[^\]]*\]/,/^./,/^$/],a.conditions={mu:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],inclusive:!1},emu:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,26],inclusive:!0}},a}();return a.lexer=b,a}();"undefined"!=typeof require&&"undefined"!=typeof exports&&(exports.parser=handlebars,exports.parse=function(){return handlebars.parse.apply(handlebars,arguments)},exports.main=function(a){if(!a[1])throw new Error("Usage: "+a[0]+" FILE");if("undefined"!=typeof process)var b=require("fs").readFileSync(require("path").join(process.cwd(),a[1]),"utf8");else var c=require("file").path(require("file").cwd()),b=c.join(a[1]).read({charset:"utf-8"});return exports.parser.parse(b)},"undefined"!=typeof module&&require.main===module&&exports.main("undefined"!=typeof process?process.argv.slice(1):require("system").args)),Handlebars.Parser=handlebars,Handlebars.parse=function(a){return Handlebars.Parser.yy=Handlebars.AST,Handlebars.Parser.parse(a)},Handlebars.print=function(a){return(new Handlebars.PrintVisitor).accept(a)},Handlebars.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(){}},Handlebars.log=function(a,b){Handlebars.logger.log(a,b)},function(){Handlebars.AST={},Handlebars.AST.ProgramNode=function(a,b){this.type="program",this.statements=a,b&&(this.inverse=new Handlebars.AST.ProgramNode(b))},Handlebars.AST.MustacheNode=function(a,b,c){this.type="mustache",this.id=a[0],this.params=a.slice(1),this.hash=b,this.escaped=!c},Handlebars.AST.PartialNode=function(a,b){this.type="partial",this.id=a,this.context=b};var a=function(a,b){if(a.original!==b.original)throw new Handlebars.Exception(a.original+" doesn't match "+b.original)};Handlebars.AST.BlockNode=function(b,c,d){a(b.id,d),this.type="block",this.mustache=b,this.program=c},Handlebars.AST.InverseNode=function(b,c,d){a(b.id,d),this.type="inverse",this.mustache=b,this.program=c},Handlebars.AST.ContentNode=function(a){this.type="content",this.string=a},Handlebars.AST.HashNode=function(a){this.type="hash",this.pairs=a},Handlebars.AST.IdNode=function(a){this.type="ID",this.original=a.join(".");for(var b=[],c=0,d=0,e=a.length;e>d;d++){var f=a[d];".."===f?c++:"."===f||"this"===f?this.isScoped=!0:b.push(f)}this.parts=b,this.string=b.join("."),this.depth=c,this.isSimple=1===b.length&&0===c},Handlebars.AST.StringNode=function(a){this.type="STRING",this.string=a},Handlebars.AST.IntegerNode=function(a){this.type="INTEGER",this.integer=a},Handlebars.AST.BooleanNode=function(a){this.type="BOOLEAN",this.bool=a},Handlebars.AST.CommentNode=function(a){this.type="comment",this.comment=a}}(),Handlebars.Exception=function(){var a=Error.prototype.constructor.apply(this,arguments);for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.message=a.message},Handlebars.Exception.prototype=new Error,Handlebars.SafeString=function(a){this.string=a},Handlebars.SafeString.prototype.toString=function(){return this.string.toString()},function(){var a={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},b=/&(?!\w+;)|[<>"'`]/g,c=/[&<>"'`]/,d=function(b){return a[b]||"&amp;"};Handlebars.Utils={escapeExpression:function(a){return a instanceof Handlebars.SafeString?a.toString():null==a||a===!1?"":c.test(a)?a.replace(b,d):a},isEmpty:function(a){return"undefined"==typeof a?!0:null===a?!0:a===!1?!0:"[object Array]"===Object.prototype.toString.call(a)&&0===a.length?!0:!1}}}(),Handlebars.Compiler=function(){},Handlebars.JavaScriptCompiler=function(){},function(a,b){a.OPCODE_MAP={appendContent:1,getContext:2,lookupWithHelpers:3,lookup:4,append:5,invokeMustache:6,appendEscaped:7,pushString:8,truthyOrFallback:9,functionOrFallback:10,invokeProgram:11,invokePartial:12,push:13,assignToHash:15,pushStringParam:16},a.MULTI_PARAM_OPCODES={appendContent:1,getContext:1,lookupWithHelpers:2,lookup:1,invokeMustache:3,pushString:1,truthyOrFallback:1,functionOrFallback:1,invokeProgram:3,invokePartial:1,push:1,assignToHash:1,pushStringParam:1},a.DISASSEMBLE_MAP={};for(var c in a.OPCODE_MAP){var d=a.OPCODE_MAP[c];a.DISASSEMBLE_MAP[d]=c}a.multiParamSize=function(b){return a.MULTI_PARAM_OPCODES[a.DISASSEMBLE_MAP[b]]},a.prototype={compiler:a,disassemble:function(){for(var b,c,d,e,f,g=this.opcodes,h=[],i=0,j=g.length;j>i;i++)if(b=g[i],"DECLARE"===b)e=g[++i],f=g[++i],h.push("DECLARE "+e+" = "+f);else{d=a.DISASSEMBLE_MAP[b];for(var k=a.multiParamSize(b),l=[],m=0;k>m;m++)c=g[++i],"string"==typeof c&&(c='"'+c.replace("\n","\\n")+'"'),l.push(c);d=d+" "+l.join(" "),h.push(d)}return h.join("\n")},guid:0,compile:function(a,b){this.children=[],this.depths={list:[]},this.options=b;var c=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},c)for(var d in c)this.options.knownHelpers[d]=c[d];return this.program(a)},accept:function(a){return this[a.type](a)},program:function(a){var b,c=a.statements;this.opcodes=[];for(var d=0,e=c.length;e>d;d++)b=c[d],this[b.type](b);return this.isSimple=1===e,this.depths.list=this.depths.list.sort(function(a,b){return a-b}),this},compileProgram:function(a){var b=(new this.compiler).compile(a,this.options),c=this.guid++;this.usePartial=this.usePartial||b.usePartial,this.children[c]=b;for(var d=0,e=b.depths.list.length;e>d;d++)depth=b.depths.list[d],2>depth||this.addDepth(depth-1);return c},block:function(a){var b,c=a.mustache,d=this.setupStackForMustache(c),e=this.compileProgram(a.program);a.program.inverse&&(b=this.compileProgram(a.program.inverse),this.declare("inverse",b)),this.opcode("invokeProgram",e,d.length,!!c.hash),this.declare("inverse",null),this.opcode("append")},inverse:function(a){var b=this.setupStackForMustache(a.mustache),c=this.compileProgram(a.program);this.declare("inverse",c),this.opcode("invokeProgram",null,b.length,!!a.mustache.hash),this.declare("inverse",null),this.opcode("append")},hash:function(a){var b,c,d=a.pairs;this.opcode("push","{}");for(var e=0,f=d.length;f>e;e++)b=d[e],c=b[1],this.accept(c),this.opcode("assignToHash",b[0])},partial:function(a){var b=a.id;this.usePartial=!0,a.context?this.ID(a.context):this.opcode("push","depth0"),this.opcode("invokePartial",b.original),this.opcode("append")},content:function(a){this.opcode("appendContent",a.string)},mustache:function(a){var b=this.setupStackForMustache(a);this.opcode("invokeMustache",b.length,a.id.original,!!a.hash),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ID:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth),this.opcode("lookupWithHelpers",a.parts[0]||null,a.isScoped||!1);for(var b=1,c=a.parts.length;c>b;b++)this.opcode("lookup",a.parts[b])},STRING:function(a){this.opcode("pushString",a.string)},INTEGER:function(a){this.opcode("push",a.integer)},BOOLEAN:function(a){this.opcode("push",a.bool)},comment:function(){},pushParams:function(a){for(var b,c=a.length;c--;)b=a[c],this.options.stringParams?(b.depth&&this.addDepth(b.depth),this.opcode("getContext",b.depth||0),this.opcode("pushStringParam",b.string)):this[b.type](b)},opcode:function(b,c,d,e){this.opcodes.push(a.OPCODE_MAP[b]),void 0!==c&&this.opcodes.push(c),void 0!==d&&this.opcodes.push(d),void 0!==e&&this.opcodes.push(e)},declare:function(a,b){this.opcodes.push("DECLARE"),this.opcodes.push(a),this.opcodes.push(b)},addDepth:function(a){0!==a&&(this.depths[a]||(this.depths[a]=!0,this.depths.list.push(a)))},setupStackForMustache:function(a){var b=a.params;return this.pushParams(b),a.hash&&this.hash(a.hash),this.ID(a.id),b}},b.prototype={nameLookup:function(a,c){return/^[0-9]+$/.test(c)?a+"["+c+"]":b.isValidJavaScriptVariableName(c)?a+"."+c:a+"['"+c+"']"},appendToBuffer:function(a){return this.environment.isSimple?"return "+a+";":"buffer += "+a+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(a,b,c,d){this.environment=a,this.options=b||{},this.name=this.environment.name,this.isChild=!!c,this.context=c||{programs:[],aliases:{self:"this"},registers:{list:[]}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.compileChildren(a,b);var e,f=a.opcodes;for(this.i=0,h=f.length;this.i<h;this.i++)e=this.nextOpcode(0),"DECLARE"===e[0]?(this.i=this.i+2,this[e[1]]=e[2]):(this.i=this.i+e[1].length,this[e[0]].apply(this,e[1]));return this.createFunctionContext(d)},nextOpcode:function(b){var c,d,e,f,g=this.environment.opcodes,h=g[this.i+b];if("DECLARE"===h)return c=g[this.i+1],d=g[this.i+2],["DECLARE",c,d];c=a.DISASSEMBLE_MAP[h],e=a.multiParamSize(h),f=[];for(var i=0;e>i;i++)f.push(g[this.i+i+1+b]);return[c,f]},eat:function(a){this.i=this.i+a.length},preamble:function(){var a=[];if(this.useRegister("foundHelper"),this.isChild)a.push("");else{var b=this.namespace,c="helpers = helpers || "+b+".helpers;";this.environment.usePartial&&(c=c+" partials = partials || "+b+".partials;"),a.push(c)}this.environment.isSimple?a.push(""):a.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=a},createFunctionContext:function(a){var b=this.stackVars;if(this.isChild||(b=b.concat(this.context.registers.list)),b.length>0&&(this.source[1]=this.source[1]+", "+b.join(", ")),!this.isChild)for(var c in this.context.aliases)this.source[1]=this.source[1]+", "+c+"="+this.context.aliases[c];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var d=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],e=0,f=this.environment.depths.list.length;f>e;e++)d.push("depth"+this.environment.depths.list[e]);if(a)return d.push(this.source.join("\n  ")),Function.apply(this,d);var g="function "+(this.name||"")+"("+d.join(",")+") {\n  "+this.source.join("\n  ")+"}";return Handlebars.log(Handlebars.logger.DEBUG,g+"\n\n"),g},appendContent:function(a){this.source.push(this.appendToBuffer(this.quotedString(a)))},append:function(){var a=this.popStack();this.source.push("if("+a+" || "+a+" === 0) { "+this.appendToBuffer(a)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var a=this.nextOpcode(1),b="";this.context.aliases.escapeExpression="this.escapeExpression","appendContent"===a[0]&&(b=" + "+this.quotedString(a[1][0]),this.eat(a)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+b))},getContext:function(a){this.lastContext!==a&&(this.lastContext=a)},lookupWithHelpers:function(a,b){if(a){var c=this.nextStack();this.usingKnownHelper=!1;var d;!b&&this.options.knownHelpers[a]?(d=c+" = "+this.nameLookup("helpers",a,"helper"),this.usingKnownHelper=!0):b||this.options.knownHelpersOnly?d=c+" = "+this.nameLookup("depth"+this.lastContext,a,"context"):(this.register("foundHelper",this.nameLookup("helpers",a,"helper")),d=c+" = foundHelper || "+this.nameLookup("depth"+this.lastContext,a,"context")),d+=";",this.source.push(d)}else this.pushStack("depth"+this.lastContext)},lookup:function(a){var b=this.topStack();this.source.push(b+" = ("+b+" === null || "+b+" === undefined || "+b+" === false ? "+b+" : "+this.nameLookup(b,a,"context")+");")},pushStringParam:function(a){this.pushStack("depth"+this.lastContext),this.pushString(a)},pushString:function(a){this.pushStack(this.quotedString(a))},push:function(a){this.pushStack(a)},invokeMustache:function(a,b,c){this.populateParams(a,this.quotedString(b),"{}",null,c,function(a,b,c){this.usingKnownHelper||(this.context.aliases.helperMissing="helpers.helperMissing",this.context.aliases.undef="void 0",this.source.push("else if("+c+"=== undef) { "+a+" = helperMissing.call("+b+"); }"),a!==c&&this.source.push("else { "+a+" = "+c+"; }"))})},invokeProgram:function(a,b,c){var d=this.programExpression(this.inverse),e=this.programExpression(a);this.populateParams(b,null,e,d,c,function(a,b){this.usingKnownHelper||(this.context.aliases.blockHelperMissing="helpers.blockHelperMissing",this.source.push("else { "+a+" = blockHelperMissing.call("+b+"); }"))})},populateParams:function(a,b,c,d,e,f){var g,h,i=e||this.options.stringParams||d||this.options.data,j=this.popStack(),k=[];if(i?(this.register("tmp1",c),h="tmp1"):h="{ hash: {} }",i){var l=e?this.popStack():"{}";this.source.push("tmp1.hash = "+l+";")}this.options.stringParams&&this.source.push("tmp1.contexts = [];");for(var m=0;a>m;m++)g=this.popStack(),k.push(g),this.options.stringParams&&this.source.push("tmp1.contexts.push("+this.popStack()+");");d&&(this.source.push("tmp1.fn = tmp1;"),this.source.push("tmp1.inverse = "+d+";")),this.options.data&&this.source.push("tmp1.data = data;"),k.push(h),this.populateCall(k,j,b||j,f,"{}"!==c)},populateCall:function(a,b,c,d,e){var f=["depth0"].concat(a).join(", "),g=["depth0"].concat(c).concat(a).join(", "),h=this.nextStack();if(this.usingKnownHelper)this.source.push(h+" = "+b+".call("+f+");");else{this.context.aliases.functionType='"function"';var i=e?"foundHelper && ":"";this.source.push("if("+i+"typeof "+b+" === functionType) { "+h+" = "+b+".call("+f+"); }")}d.call(this,h,g,b),this.usingKnownHelper=!1},invokePartial:function(a){params=[this.nameLookup("partials",a,"partial"),"'"+a+"'",this.popStack(),"helpers","partials"],this.options.data&&params.push("data"),this.pushStack("self.invokePartial("+params.join(", ")+");")},assignToHash:function(a){var b=this.popStack(),c=this.topStack();this.source.push(c+"['"+a+"'] = "+b+";")},compiler:b,compileChildren:function(a,b){for(var c,d,e=a.children,f=0,g=e.length;g>f;f++){c=e[f],d=new this.compiler,this.context.programs.push("");var h=this.context.programs.length;c.index=h,c.name="program"+h,this.context.programs[h]=d.compile(c,b,this.context)}},programExpression:function(a){if(null==a)return"self.noop";for(var b=this.environment.children[a],c=b.depths.list,d=[b.index,b.name,"data"],e=0,f=c.length;f>e;e++)depth=c[e],1===depth?d.push("depth0"):d.push("depth"+(depth-1));return 0===c.length?"self.program("+d.join(", ")+")":(d.shift(),"self.programWithDepth("+d.join(", ")+")")},register:function(a,b){this.useRegister(a),this.source.push(a+" = "+b+";")},useRegister:function(a){this.context.registers[a]||(this.context.registers[a]=!0,this.context.registers.list.push(a))},pushStack:function(a){return this.source.push(this.nextStack()+" = "+a+";"),"stack"+this.stackSlot},nextStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){return"stack"+this.stackSlot--},topStack:function(){return"stack"+this.stackSlot},quotedString:function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'}};for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),f=b.RESERVED_WORDS={},g=0,h=e.length;h>g;g++)f[e[g]]=!0;b.isValidJavaScriptVariableName=function(a){return!b.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(a)?!0:!1}}(Handlebars.Compiler,Handlebars.JavaScriptCompiler),Handlebars.precompile=function(a,b){b=b||{};var c=Handlebars.parse(a),d=(new Handlebars.Compiler).compile(c,b);return(new Handlebars.JavaScriptCompiler).compile(d,b)},Handlebars.compile=function(a,b){function c(){var c=Handlebars.parse(a),d=(new Handlebars.Compiler).compile(c,b),e=(new Handlebars.JavaScriptCompiler).compile(d,b,void 0,!0);return Handlebars.template(e)}b=b||{};var d;return function(a,b){return d||(d=c()),d.call(this,a,b)}},Handlebars.VM={template:function(a){var b={escapeExpression:Handlebars.Utils.escapeExpression,invokePartial:Handlebars.VM.invokePartial,programs:[],program:function(a,b,c){var d=this.programs[a];return c?Handlebars.VM.program(b,c):d?d:d=this.programs[a]=Handlebars.VM.program(b)},programWithDepth:Handlebars.VM.programWithDepth,noop:Handlebars.VM.noop};return function(c,d){return d=d||{},a.call(b,Handlebars,c,d.helpers,d.partials,d.data)}},programWithDepth:function(a,b){var c=Array.prototype.slice.call(arguments,2);return function(d,e){return e=e||{},a.apply(this,[d,e.data||b].concat(c))}},program:function(a,b){return function(c,d){return d=d||{},a(c,d.data||b)}},noop:function(){return""},invokePartial:function(a,b,c,d,e,f){if(options={helpers:d,partials:e,data:f},void 0===a)throw new Handlebars.Exception("The partial "+b+" could not be found");if(a instanceof Function)return a(c,options);if(!Handlebars.compile)throw new Handlebars.Exception("The partial "+b+" could not be compiled when running in runtime-only mode");return e[b]=Handlebars.compile(a),e[b](c,options)}},Handlebars.template=Handlebars.VM.template,!function(a){a(function(){a.support.transition=function(){var b=document.body||document.documentElement,c=b.style,d=void 0!==c.transition||void 0!==c.WebkitTransition||void 0!==c.MozTransition||void 0!==c.MsTransition||void 0!==c.OTransition;return d&&{end:function(){var b="TransitionEnd";return a.browser.webkit?b="webkitTransitionEnd":a.browser.mozilla?b="transitionend":a.browser.opera&&(b="oTransitionEnd"),b}()}}()})}(window.jQuery),!function(a){"use strict";var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype={constructor:c,close:function(b){function c(){d.remove(),d.trigger("closed")}var d,e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),d=a(f),d.trigger("close"),b&&b.preventDefault(),d.length||(d=e.hasClass("alert")?e:e.parent()),d.removeClass("in"),a.support.transition&&d.hasClass("fade")?d.on(a.support.transition.end,c):c()}},a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("alert");e||d.data("alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a(function(){a("body").on("click.alert.data-api",b,c.prototype.close)})}(window.jQuery),!function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.button.defaults,c)};b.prototype={constructor:b,setState:function(a){var b="disabled",c=this.$element,d=c.data(),e=c.is("input")?"val":"html";a+="Text",d.resetText||c.data("resetText",c[e]()),c[e](d[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},toggle:function(){var a=this.$element.parent('[data-toggle="buttons-radio"]');a&&a.find(".active").removeClass("active"),this.$element.toggleClass("active")}},a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("button"),f="object"==typeof c&&c;e||d.data("button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.defaults={loadingText:"loading..."},a.fn.button.Constructor=b,a(function(){a("body").on("click.button.data-api","[data-toggle^=button]",function(b){a(b.target).button("toggle")})})}(window.jQuery),!function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.carousel.defaults,c),this.options.slide&&this.slide(this.options.slide)};b.prototype={cycle:function(){return this.interval=setInterval(a.proxy(this.next,this),this.options.interval),this},to:function(b){var c=this.$element.find(".active"),d=c.parent().children(),e=d.index(c),f=this;if(!(b>d.length-1||0>b))return this.sliding?this.$element.one("slid",function(){f.to(b)}):e==b?this.pause().cycle():this.slide(b>e?"next":"prev",a(d[b]))},pause:function(){return clearInterval(this.interval),this},next:function(){return this.sliding?void 0:this.slide("next")},prev:function(){return this.sliding?void 0:this.slide("prev")},slide:function(b,c){var d=this.$element.find(".active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;return this.sliding=!0,f&&this.pause(),e=e.length?e:this.$element.find(".item")[h](),!a.support.transition&&this.$element.hasClass("slide")?(this.$element.trigger("slide"),d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid")):(e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),this.$element.trigger("slide"),this.$element.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid")},0)})),f&&this.cycle(),this}},a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("carousel"),f="object"==typeof c&&c;e||d.data("carousel",e=new b(this,f)),"number"==typeof c?e.to(c):"string"==typeof c||(c=f.slide)?e[c]():e.cycle()})},a.fn.carousel.defaults={interval:5e3},a.fn.carousel.Constructor=b,a(function(){a("body").on("click.carousel.data-api","[data-slide]",function(b){var c,d=a(this),e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),f=!e.data("modal")&&a.extend({},e.data(),d.data());e.carousel(f),b.preventDefault()})})}(window.jQuery),!function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.collapse.defaults,c),this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var a=this.$element.hasClass("width");return a?"width":"height"},show:function(){var b,c=this.dimension(),d=a.camelCase(["scroll",c].join("-")),e=this.$parent&&this.$parent.find(".in");e&&e.length&&(b=e.data("collapse"),e.collapse("hide"),b||e.data("collapse",null)),this.$element[c](0),this.transition("addClass","show","shown"),this.$element[c](this.$element[0][d])},hide:function(){var a=this.dimension();this.reset(this.$element[a]()),this.transition("removeClass","hide","hidden"),this.$element[a](0)},reset:function(a){var b=this.dimension();this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth,this.$element.addClass("collapse")},transition:function(b,c,d){var e=this,f=function(){"show"==c&&e.reset(),e.$element.trigger(d)};this.$element.trigger(c)[b]("in"),a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,f):f()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("collapse"),f="object"==typeof c&&c;e||d.data("collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.defaults={toggle:!0},a.fn.collapse.Constructor=b,a(function(){a("body").on("click.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e).data("collapse")?"toggle":d.data();a(e).collapse(f)})})}(window.jQuery),!function(a){function b(){a(c).parent().removeClass("open")}var c='[data-toggle="dropdown"]',d=function(b){var c=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};d.prototype={constructor:d,toggle:function(){var c,d,e=a(this),f=e.attr("data-target");return f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),c=a(f),c.length||(c=e.parent()),d=c.hasClass("open"),b(),!d&&c.toggleClass("open"),!1}},a.fn.dropdown=function(b){return this.each(function(){var c=a(this),e=c.data("dropdown");e||c.data("dropdown",e=new d(this)),"string"==typeof b&&e[b].call(c)})},a.fn.dropdown.Constructor=d,a(function(){a("html").on("click.dropdown.data-api",b),a("body").on("click.dropdown.data-api",c,d.prototype.toggle)})}(window.jQuery),!function(a){function b(){var b=this,d=setTimeout(function(){b.$element.off(a.support.transition.end),c.call(b)},500);this.$element.one(a.support.transition.end,function(){clearTimeout(d),c.call(b)})}function c(){this.$element.hide().trigger("hidden"),d.call(this)}function d(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),"static"!=this.options.backdrop&&this.$backdrop.click(a.proxy(this.hide,this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),d?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,a.proxy(e,this)):e.call(this)):b&&b()}function e(){this.$backdrop.remove(),this.$backdrop=null}function f(){var b=this;this.isShown&&this.options.keyboard?a(document).on("keyup.dismiss.modal",function(a){27==a.which&&b.hide()}):this.isShown||a(document).off("keyup.dismiss.modal")}var g=function(b,c){this.options=a.extend({},a.fn.modal.defaults,c),this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this))};g.prototype={constructor:g,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this;this.isShown||(a("body").addClass("modal-open"),this.isShown=!0,this.$element.trigger("show"),f.call(this),d.call(this,function(){var c=a.support.transition&&b.$element.hasClass("fade");!b.$element.parent().length&&b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in"),c?b.$element.one(a.support.transition.end,function(){b.$element.trigger("shown")}):b.$element.trigger("shown")}))},hide:function(d){d&&d.preventDefault(),this.isShown&&(this.isShown=!1,a("body").removeClass("modal-open"),f.call(this),this.$element.trigger("hide").removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?b.call(this):c.call(this))}},a.fn.modal=function(b){return this.each(function(){var c=a(this),d=c.data("modal"),e="object"==typeof b&&b;d||c.data("modal",d=new g(this,e)),"string"==typeof b?d[b]():d.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0},a.fn.modal.Constructor=g,a(function(){a("body").on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c,d=a(this),e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({},e.data(),d.data());b.preventDefault(),e.modal(f)})})}(window.jQuery),!function(a){"use strict";var b=function(a,b){this.init("tooltip",a,b)};b.prototype={constructor:b,init:function(b,c,d){var e,f;this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,"manual"!=this.options.trigger&&(e="hover"==this.options.trigger?"mouseenter":"focus",f="hover"==this.options.trigger?"mouseleave":"blur",this.$element.on(e,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f,this.options.selector,a.proxy(this.leave,this))),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,b,this.$element.data()),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c.options.delay&&c.options.delay.show?(c.hoverState="in",setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show()},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);c.options.delay&&c.options.delay.hide?(c.hoverState="out",setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},show:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){switch(a=this.tip(),this.setContent(),this.options.animation&&a.addClass("fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),a.remove().css({top:0,left:0,display:"block"}).appendTo(b?this.$element:document.body),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight,b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g).addClass(f).addClass("in")}},setContent:function(){var a=this.tip();a.find(".tooltip-inner").html(this.getTitle()),a.removeClass("fade in top bottom left right")},hide:function(){function b(){var b=setTimeout(function(){c.off(a.support.transition.end).remove()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.remove()})}var c=this.tip();c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?b():c.remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(b){return a.extend({},b?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title),a=a.toString().replace(/(^\s*|\s*$)/,"")},tip:function(){return this.$tip=this.$tip||a(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("tooltip"),f="object"==typeof c&&c;e||d.data("tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.defaults={animation:!0,delay:0,selector:!1,placement:"top",trigger:"hover",title:"",template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'}}(window.jQuery),!function(a){"use strict";var b=function(a,b){this.init("popover",a,b)};b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var b=this.tip(),c=this.getTitle(),d=this.getContent();b.find(".popover-title")["object"==a.type(c)?"append":"html"](c),b.find(".popover-content > *")["object"==a.type(d)?"append":"html"](d),b.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-content")||("function"==typeof c.content?c.content.call(b[0]):c.content),a=a.toString().replace(/(^\s*|\s*$)/,"")},tip:function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip}}),a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("popover"),f="object"==typeof c&&c;e||d.data("popover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.defaults=a.extend({},a.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(a){function b(b,c){var d,e=a.proxy(this.process,this),f=a(b).is("body")?a(window):a(b);this.options=a.extend({},a.fn.scrollspy.defaults,c),this.$scrollElement=f.on("scroll.scroll.data-api",e),this.selector=(this.options.target||(d=a(b).attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=a("body").on("click.scroll.data-api",this.selector,e),this.refresh(),this.process()
}b.prototype={constructor:b,refresh:function(){this.targets=this.$body.find(this.selector).map(function(){var b=a(this).attr("href");return/^#\w/.test(b)&&a(b).length?b:null}),this.offsets=a.map(this.targets,function(b){return a(b).position().top})},process:function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.offsets,d=this.targets,e=this.activeTarget;for(a=c.length;a--;)e!=d[a]&&b>=c[a]&&(!c[a+1]||b<=c[a+1])&&this.activate(d[a])},activate:function(a){var b;this.activeTarget=a,this.$body.find(this.selector).parent(".active").removeClass("active"),b=this.$body.find(this.selector+'[href="'+a+'"]').parent("li").addClass("active"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active")}},a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("scrollspy"),f="object"==typeof c&&c;e||d.data("scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.defaults={offset:10},a(function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(window.jQuery),!function(a){"use strict";var b=function(b){this.element=a(b)};b.prototype={constructor:b,show:function(){var b,c,d=this.element,e=d.closest("ul:not(.dropdown-menu)"),f=d.attr("data-target");f||(f=d.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),d.parent("li").hasClass("active")||(b=e.find(".active a").last()[0],d.trigger({type:"show",relatedTarget:b}),c=a(f),this.activate(d.parent("li"),e),this.activate(c,c.parent(),function(){d.trigger({type:"shown",relatedTarget:b})}))},activate:function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one(a.support.transition.end,e):e(),f.removeClass("in")}},a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("tab");e||d.data("tab",e=new b(this)),"string"==typeof c&&e[c]()})},a.fn.tab.Constructor=b,a(function(){a("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})})}(window.jQuery),!function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.$menu=a(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};b.prototype={constructor:b,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(a),this.hide()},show:function(){var b=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:b.top+b.height,left:b.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(){var b,c=this;return this.query=this.$element.val(),this.query?(b=a.grep(this.source,function(a){return c.matcher(a)?a:void 0}),b=this.sorter(b),b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b,c=[],d=[],e=[];b=a.shift();)b.toLowerCase().indexOf(this.query.toLowerCase())?~b.indexOf(this.query)?d.push(b):e.push(b):c.push(b);return c.concat(d,e)},highlighter:function(a){return a.replace(new RegExp("("+this.query+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(){var b=this.$menu.find(".active").removeClass("active"),c=b.next();c.length||(c=a(this.$menu.find("li")[0])),c.addClass("active")},prev:function(){var a=this.$menu.find(".active").removeClass("active"),b=a.prev();b.length||(b=this.$menu.find("li").last()),b.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),(a.browser.webkit||a.browser.msie)&&this.$element.on("keydown",a.proxy(this.keypress,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},keyup:function(a){switch(a.stopPropagation(),a.preventDefault(),a.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:this.hide();break;default:this.lookup()}},keypress:function(a){if(a.stopPropagation(),this.shown)switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}},blur:function(a){var b=this;a.stopPropagation(),a.preventDefault(),setTimeout(function(){b.hide()},150)},click:function(a){a.stopPropagation(),a.preventDefault(),this.select()},mouseenter:function(b){this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")}},a.fn.typeahead=function(c){return this.each(function(){var d=a(this),e=d.data("typeahead"),f="object"==typeof c&&c;e||d.data("typeahead",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},a.fn.typeahead.Constructor=b,a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);c.data("typeahead")||(b.preventDefault(),c.typeahead(c.data()))})})}(window.jQuery),function(a){"use strict";function b(){var a=i(".dataset-info"),b=i(".import-options");i(".import-options .import-nondatahub a.btn").click(function(){b.hide(),a.show()}),i(".import-datahub form").submit(function(c){c.preventDefault();var d,e=i(c.target);e.find('input[type="submit"]').val("Loading, please wait ..."),d=e.find('input[name="datahubUrl"]').val(),getCkanDatasetInfo(d).then(function(c){a.find('form input[name="label"]').val(c.title),a.find('form input[name="name"]').val(c.name),a.find('form input[name="ckan_uri"]').val(d),a.find('form textarea[name="description"]').val(c.notes),b.hide(),a.show()})})}function c(a){a.each(function(a,b){b=i(b);var c=b.attr("ckan-uri");c&&getCkanDatasetInfo(c).then(function(a){var c,d=b.find('input[name="url"]');d.hide(),d.after(i('<select name="url"></select>')),c=b.find("select"),i.each(a.resources,function(a,b){var d=b.name+" -- "+b.description+" -- "+b.url,e=i("<option />").val(b.url).text(d);c.append(e)})})})}function d(){i(".select-locale").click(function(){i.ajax({url:"/set-locale",data:{locale:i(this).data("locale")},type:"POST",async:!1}),window.location.reload()})}function e(a){var b=i("#datasets-list"),c=Handlebars.compile(i("#listing-item-template").html()),d=i("#datasets-filter-query").val();d&&d.length&&(d=d.toLowerCase(),a=_.filter(a,function(a){return-1!=_.indexOf(a.name.toLowerCase(),d)||-1!=_.indexOf(a.label.toLowerCase(),d)||-1!=_.indexOf(a.description.toLowerCase(),d)})),b.empty(),_.each(a,function(a){b.append(c(a))})}function f(a){a=a||{};var b,c;b=i("#datasets"),c=i.ajax({url:"/datasets.json",data:a}),c.then(function(c){var d=b.find(".listing").first();d.empty(),c.params=a,c.hasTerritories=c.territories.length>0,c.territories=_.map(c.territories,function(b){return b.selected=b.code===a.territories,b}),c.hasLanguages=c.languages.length>0,c.languages=_.map(c.languages,function(b){return b.selected=b.code===a.languages,b}),c.hasCategories=c.categories.length>0,c.hasSelectedCategory=!1,c.categories=_.map(c.categories,function(b){return b.selected=b.category===a.category,b.selected&&(c.hasSelectedCategory=!0),b}),c.datasets=_.map(c.datasets,function(a){return a.tagline=a.description.substring(0,120),a.description.length>120&&(a.tagline+="..."),a});var g=i("#datasets-filter-query").val();g&&g.length&&(c.datasets=_.filter(c.datasets,function(a){return-1!=a.name.indefOf(g)||-1!=a.label.indefOf(g)||-1!=a.description.indefOf(g)}));var h=Handlebars.compile(i("#listing-template").html());d.append(h(c)),i(".filter-datasets").change(function(b){var c=i(b.target);a.filter=i("#datasets-filter-query").val(),a[c.attr("name")]=c.val().length?c.val():void 0,f(a)}),i("#datasets-filter-query").val(a.filter),e(c.datasets),i("#datasets-filter-query").keyup(function(){e(c.datasets)}),b.is(":hidden")&&b.modal({backdrop:!0})})}function g(){i(".list-datasets").click(function(){return f(),!1}),i(".fp-map svg").click(function(){return!1})}var h,i;a.OpenSpending=h={},h.getGlobal=function(){return a},i=h.$=h.jQuery=jQuery,h.ajaxError=function(a){return function(b,c,d){var e="OpenSpending Ajax Error: "+a+" ("+d+")";void 0!==h.getGlobal().console?console.error(e,b):alert(e+": "+b)}},h.getGlobal().updateDatasetListing=f,i(function(){var a=i(".container .dataset.new").length>0;a&&b(),c(i("#new-source")),d(),g()})}(this),function(a){var b=["#CA221D","#C22769","#3F93E1","#481B79","#6AAC32","#42928F","#D32645","#CD531C","#EDC92D","#A5B425","#211D79","#449256","#7A2077","#CA221D","#E29826","#44913D","#2458A3","#2458A3","#14388C"];a.OpenSpending=a.OpenSpending||{},OpenSpending.Utils=OpenSpending.Utils||{},OpenSpending.Utils.formatAmount=function(a){var b=1e9,c=1e6,d=1e3,e=Math.abs(a);return e>b?OpenSpending.Utils.formatAmountWithCommas(a/b)+"bn":e>c/2?OpenSpending.Utils.formatAmountWithCommas(a/c)+"m":e>d?OpenSpending.Utils.formatAmountWithCommas(a/d)+"k":OpenSpending.Utils.formatAmountWithCommas(a,2)},OpenSpending.Utils.formatAmountWithCommas=function(a,b,c){return c=OpenSpending.Utils.currencySymbol(c),accounting.formatMoney(a,c,b||0,OpenSpending.localeGroupSeparator,OpenSpending.localeDecimalSeparator)},OpenSpending.Utils.currencySymbol=function(a){return a?OpenSpending.Utils.CurrencySymbols[a]||a:""},OpenSpending.Utils.getColorPalette=function(a){for(var c=[],d=0;a>d;d++)c.push(b[d%(b.length-1)]);return c},writeTabularAsHtml=function(a){var b={};arguments.length>1&&(b=arguments[1]);var c={},d={};b.colTypes&&(c=b.colTypes),b.displayNames&&(d=b.displayNames);var e=[],f=$("<thead></thead>");$.each(a.header,function(a,b){var g=d[b]?d[b]:b;f.append($("<th></th>").append(g)),c[b]&&(e[a]=c[b])});var g=$("<tbody></tbody>"),h=/^[\d\.\-]+$/,i=/^$/;return $.each(a.data,function(a,b){var c=$("<tr></tr>");$.each(b,function(a,b){var d;if("range"==e[a]){var f=parseFloat(b);f++,d=b+"-"+f,c.append($("<td></td>").append(d))}else if(i.test(b))d="",c.append($("<td></td>").append(d));else if("percent"==e[a]){var f=100*b;d=f.toFixed(1)+"%",c.append($('<td class="amount"></td>').append(d))}else if(h.test(b)){var f=parseFloat(b);d=f.toFixed(0),c.append($('<td class="amount"></td>').append(d))}else d=b,c.append($("<td></td>").append(d))}),g.append(c)}),{thead:f,tbody:g}},OpenSpending.Utils.CurrencySymbols={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"դր.",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"m",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:"ب.د",BIF:"Fr",BMD:"$",BND:"$",BOB:"Bs.",BRL:"R$",BSD:"$",BTN:"Nu",BWP:"P",BYR:"Br",BZD:"$",CAD:"$",CDF:"Fr",CHF:"Fr",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUP:"$",CVE:"$, Esc",CZK:"Kč",DJF:"Fr",DKK:"kr",DOP:"$",DZD:"د.ج",EEK:"KR",EGP:"£,ج.م",ERN:"Nfk",ETB:"Br",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"ლ",GHS:"₵",GIP:"£",GMD:"D",GNF:"Fr",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",INR:"₨",IQD:"ع.د",IRR:"﷼",ISK:"kr",JMD:"$",JOD:"د.ا",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"Fr",KPW:"₩",KRW:"₩",KWD:"د.ك",KYD:"$",KZT:"Т",LAK:"₭",LBP:"ل.ل",LKR:"ரூ",LRD:"$",LSL:"L",LTL:"Lt",LVL:"Ls",LYD:"ل.د",MAD:"د.م.",MDL:"MDL",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"P",MRO:"UM",MUR:"₨",MVR:"ރ.",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"ر.ع.",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"₲",QAR:"ر.ق",RON:"RON",RSD:"RSD",RUB:"р.",RWF:"Fr",SAR:"ر.س",SBD:"$",SCR:"₨",SDG:"S$",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"Sh",SRD:"$",STD:"Db",SYP:"£, ل.س",SZL:"L",THB:"฿",TJS:"ЅМ",TMT:"m",TND:"د.ت",TOP:"T$",TRY:"₤",TTD:"$",TWD:"$",TZS:"Sh",UAH:"₴",UGX:"Sh",USD:"$",UYU:"$",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"Vt",WST:"T",XAF:"Fr",XCD:"$",XOF:"Fr",XPF:"Fr",YER:"﷼",ZAR:"R",ZMK:"ZK",ZWL:"$"}}(this);var OpenSpending=OpenSpending||{};!function(a){var b={siteUrl:"http://openspending.org",dataset:"cra",drilldowns:["cofog1","cofog2","cofog3"],cuts:["year:2008"],breakdown:"region",rootNodeLabel:"Total",localApiCache:"aggregate.json",measure:"amount",processEntry:function(a){return a},callback:function(){}};OpenSpending.aggregatorConfigFromQueryString=function(a){if(a)var b=parseQueryString(a);else var b=parseQueryString();var c={};return _.each(b,function(a){var b=a[0],d=a[1];"breakdown"==b?c.breakdown=d:"drilldown"==b?c.drilldowns=d.split("|"):"cut"==b&&(c.cuts=d.split("|"))}),c},OpenSpending.Aggregator=function(c){var d=this;d.config=c?c:b,d.config.processEntry||(d.config.processEntry=b.processEntry),d.config.measure||(d.config.measure="amount"),d.queryData=function(){var b={},c=d.config;b.dataset=c.dataset,b.drilldown=c.drilldowns.join("|"),b.order=c.order,b.page=c.page,b.pagesize=c.pagesize,void 0!==c.cuts&&(b.cut=c.cuts.join("|"));var e=c.drilldowns.slice();return void 0!==c.breakdown&&c.breakdown.length&&e.push(c.breakdown),e=a.unique(e),b.drilldown=e.join("|"),b},d.queryUrl=function(){var a=d.config;return void 0!==a.localApiCache?a.localApiCache:(apiUrl=a.apiUrl||a.siteUrl+"/api",apiUrl+"/2/aggregate")},d.getTree=function(){var b=d.queryData(),c=window.btoa(a.param(b)).replace(/\=/g,"");a.ajax({url:d.queryUrl(),cache:!0,data:b,jsonpCallback:"aggregate_"+c,dataType:void 0!==d.config.localApiCache?"json":"jsonp",context:d,success:d.onJSONTreeLoaded})},d.getCSVURL=function(){var b=d.queryUrl(),c=d.queryData();return c.format="csv",b+"?"+a.param(c)},d.onJSONTreeLoaded=function(b){var c=d.buildTree(b);a.isFunction(d.config.callback)&&d.config.callback(c)},d.buildTree=function(b){var c=b.drilldown,e=d.config,f=e.drilldowns,g=(e.breakdown,{label:e.rootNodeLabel}),h={},i={id:"root",label:"Total",color:"#555",currency:b.summary.currency[d.config.measure],children:[],level:0,breakdowns:{}};i[d.config.measure]=0,void 0!==g&&a.extend(!0,i,g),h.root=i;for(var j in f){var k=f[j];h[k]={}}if(void 0!==b.errors)throw"Error";for(var l=0;l<c.length;l++){var m=d.config.processEntry(c[l],b);d.processEntry(m,h)}return h.root},d.processEntry=function(a,b){var c,e,f,g,h=b.root,i=0,j=d.config.drilldowns;for(var k in j)c=j[k],i+=1,e=a[c],g=d.toNode(e,h),f=b[g.id],void 0===f&&(f=g,f.children=[],f[d.config.measure]=0,f.color=e?e.color:void 0,f.level=i,f.breakdowns={},f.currency=h.currency,h.children.push(f),b[f.id]=f),f[d.config.measure]=f[d.config.measure]+a[d.config.measure],1===i&&(b.root[d.config.measure]=b.root[d.config.measure]+a[d.config.measure],d.addBreakdown(b.root,a)),d.addBreakdown(f,a),h=f},d.addBreakdown=function(a,b){var c=d.config.breakdown;if(void 0!==c){var e,f,g,h;e=b[c],g=d.toNode(e),h=g.id,f=a.breakdowns[h],void 0===f&&(f=g,a.breakdowns[h]=f),f[d.config.measure]=f[d.config.measure]+b[d.config.measure]}},d.toNode=function(b,c){var e=typeof b,f={};if(prefix=c?c.id+"__":"",void 0===b||null===b)f.id="others",f.label="Others",f.name="others";else if("object"===e)void 0===b.id?(f.id="others",f.label="Others",f.name="others"):(a.extend(!0,f,b),f.name||(f.name=f.label?f.label.toLowerCase().replace(/\W/g,"-"):f.id));else if("boolean"===e)b?(f.id="yes",f.label="Yes",f.name="yes"):(f.id="no",f.label="No",f.name="no");else{if("string"!==e&&"number"!==e)throw"unsupported type: "+e;f.id=b+"",f.label=b+"",f.name=f.id.toLowerCase().replace(/\W/g,"-")}return f.id=prefix+f.id,f[d.config.measure]=0,f},d.getTree()}}(jQuery),function(a){var b=["#CA221D","#C22769","#3F93E1","#481B79","#6AAC32","#42928F","#D32645","#CD531C","#EDC92D","#A5B425","#211D79","#449256","#7A2077","#CA221D","#E29826","#44913D","#2458A3","#2458A3","#14388C"];a.OpenSpending=a.OpenSpending||{},OpenSpending.Utils=OpenSpending.Utils||{},OpenSpending.Utils.formatAmount=function(a){var b=1e9,c=1e6,d=1e3,e=Math.abs(a);return e>b?OpenSpending.Utils.formatAmountWithCommas(a/b)+"bn":e>c/2?OpenSpending.Utils.formatAmountWithCommas(a/c)+"m":e>d?OpenSpending.Utils.formatAmountWithCommas(a/d)+"k":OpenSpending.Utils.formatAmountWithCommas(a,2)},OpenSpending.Utils.formatAmountWithCommas=function(a,b,c){return c=OpenSpending.Utils.currencySymbol(c),accounting.formatMoney(a,c,b||0,OpenSpending.localeGroupSeparator,OpenSpending.localeDecimalSeparator)},OpenSpending.Utils.currencySymbol=function(a){return a?OpenSpending.Utils.CurrencySymbols[a]||a:""},OpenSpending.Utils.getColorPalette=function(a){for(var c=[],d=0;a>d;d++)c.push(b[d%(b.length-1)]);return c},writeTabularAsHtml=function(a){var b={};arguments.length>1&&(b=arguments[1]);var c={},d={};b.colTypes&&(c=b.colTypes),b.displayNames&&(d=b.displayNames);var e=[],f=$("<thead></thead>");$.each(a.header,function(a,b){var g=d[b]?d[b]:b;f.append($("<th></th>").append(g)),c[b]&&(e[a]=c[b])});var g=$("<tbody></tbody>"),h=/^[\d\.\-]+$/,i=/^$/;return $.each(a.data,function(a,b){var c=$("<tr></tr>");$.each(b,function(a,b){var d;if("range"==e[a]){var f=parseFloat(b);f++,d=b+"-"+f,c.append($("<td></td>").append(d))}else if(i.test(b))d="",c.append($("<td></td>").append(d));else if("percent"==e[a]){var f=100*b;d=f.toFixed(1)+"%",c.append($('<td class="amount"></td>').append(d))}else if(h.test(b)){var f=parseFloat(b);d=f.toFixed(0),c.append($('<td class="amount"></td>').append(d))}else d=b,c.append($("<td></td>").append(d))}),g.append(c)}),{thead:f,tbody:g}},OpenSpending.Utils.CurrencySymbols={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"դր.",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"m",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:"ب.د",BIF:"Fr",BMD:"$",BND:"$",BOB:"Bs.",BRL:"R$",BSD:"$",BTN:"Nu",BWP:"P",BYR:"Br",BZD:"$",CAD:"$",CDF:"Fr",CHF:"Fr",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUP:"$",CVE:"$, Esc",CZK:"Kč",DJF:"Fr",DKK:"kr",DOP:"$",DZD:"د.ج",EEK:"KR",EGP:"£,ج.م",ERN:"Nfk",ETB:"Br",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"ლ",GHS:"₵",GIP:"£",GMD:"D",GNF:"Fr",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",INR:"₨",IQD:"ع.د",IRR:"﷼",ISK:"kr",JMD:"$",JOD:"د.ا",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"Fr",KPW:"₩",KRW:"₩",KWD:"د.ك",KYD:"$",KZT:"Т",LAK:"₭",LBP:"ل.ل",LKR:"ரூ",LRD:"$",LSL:"L",LTL:"Lt",LVL:"Ls",LYD:"ل.د",MAD:"د.م.",MDL:"MDL",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"P",MRO:"UM",MUR:"₨",MVR:"ރ.",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"ر.ع.",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"₲",QAR:"ر.ق",RON:"RON",RSD:"RSD",RUB:"р.",RWF:"Fr",SAR:"ر.س",SBD:"$",SCR:"₨",SDG:"S$",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"Sh",SRD:"$",STD:"Db",SYP:"£, ل.س",SZL:"L",THB:"฿",TJS:"ЅМ",TMT:"m",TND:"د.ت",TOP:"T$",TRY:"₤",TTD:"$",TWD:"$",TZS:"Sh",UAH:"₴",UGX:"Sh",USD:"$",UYU:"$",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"Vt",WST:"T",XAF:"Fr",XCD:"$",XOF:"Fr",XPF:"Fr",YER:"﷼",ZAR:"R",ZMK:"ZK",ZWL:"$"}}(this);var OpenSpending=OpenSpending||{};OpenSpending.Widgets=OpenSpending.Widgets||{},function(a){var b=OpenSpending.Widgets;b.QueryBuilder=function(c,d,e,f,g){var h=this,i=["//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js","//ajax.googleapis.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js",OpenSpending.scriptRoot+"/app/bob/css/query-builder/jquery-ui-1.8.18.custom.css",OpenSpending.scriptRoot+"/lib/vendor/handlebars.js"];h.nodes={},h.hasFinish=e instanceof Function,h.noFinish=!h.hasFinish,h.context=_.extend({},f),h.serialize=function(){return state={},_.each(g,function(a){var b=h.nodes[a.variable];b&&(state[a.variable]=b.serialize()),state[a.variable]=state[a.variable]||a["default"]}),state},h.update=function(){return d(h.serialize()),!1},h.render=function(){a.ajax({url:f.siteUrl+"/"+f.dataset+"/model.json",cache:!0,jsonpCallback:"qbmodel",success:function(d){d.dimensions={},d.measures={},_.each(_.keys(d.mapping),function(a){var b=d.mapping[a];b.name=a,"measure"==b.type?d.measures[a]=b:d.dimensions[a]=b}),h.id="qb"+Math.floor(11*Math.random()),c.append(h.template(h));var f=a("#"+h.id+" .insert-here");_.each(g,function(a){a.id=a.variable+"-"+Math.floor(11*Math.random());var c=b.QueryNodes[a.type];c&&(h.nodes[a.variable]=new c(h,f,a,d))}),a("#"+h.id+" .qb-toggle").click(function(b){var c=a(b.currentTarget);return c.find("i").toggleClass("icon-chevron-up").toggleClass("icon-chevron-down"),a("#"+h.id+" .fields").slideToggle("fast"),!1}),a("#"+h.id+" .qb-quit").click(function(){return a("#"+h.id).parents(".query-builder").remove(),!1}),f.change(h.update),f.submit(h.update),c.find(".finish").click(function(){return e(),!1})},dataType:"jsonp"})},h.fetchDistinct=function(b,c,d){var e=a.ajax({url:f.siteUrl+"/"+f.dataset+"/"+b+".distinct",data:{attribute:c,q:d,limit:20},dataType:"jsonp",cache:!0,jsonpCallback:"distinct_"+btoa(b+"__"+c+"__"+d).replace(/\=/g,"")});return e.promise()},h.initTemplates=function(){h.template=Handlebars.compile("             <div class='well query-builder'>                 <form id='{{id}}' class='form-horizontal'>                     {{#noFinish}}                         <a class='qb-quit close' href='#'><i class='icon-remove'></i></a>                     {{/noFinish}}                     {{#hasFinish}}                         <a class='qb-toggle close' href='#'><i class='icon-chevron-up'></i></a>                     {{/hasFinish}}                     <div class='fields'>                     <div class='insert-here'></div>                     {{#hasFinish}}                     <div class='control-group'>                         <div class='controls'>                             <a href='#' class='btn finish'><i class='icon-ok'></i> Save or embed this view</a>                         </div>                     </div>                     {{/hasFinish}}                     </div>                 </form>             </div>")},h.init=function(){h.initTemplates(),h.render()},window.queryBuilderLoaded?h.init():yepnope({load:i,complete:function(){window.queryBuilderLoaded=!0,h.init()}})},b.SliderNode=function(a,b,c){var d=this;c=_.extend({label:"Year",dimension:"time",attribute:"year"},c),d.serialize=function(){return d.value},d.update=function(b){b!=d.value&&(d.value=b,d.nodeElem.find(".num").html(b),a.update())},d.nodeTemplate=Handlebars.compile("         <div class='{{obj.type}} control-group' id='{{obj.id}}'>             <label for='{{obj.id}}' class='control-label'>{{obj.label}}</label>             <div class='controls'>                 <div class='num'></div>                 <div class='slider'></div>                 {{#obj.help}}<p class='help-block'>{{this}}</p>{{/obj.help}}             </div>         </div>"),b.append(d.nodeTemplate({obj:c})),d.nodeElem=b.find("#"+c.id),d.sliderElem=d.nodeElem.find(".slider"),a.fetchDistinct(c.dimension,c.attribute).then(function(a){var b=_.map(a.results,function(a){return parseFloat(a[c.attribute])});d.sliderElem.slider({value:d.value,min:_.min(b),max:_.max(b),step:1,change:function(a,b){d.update(b.value)}}),d.sliderElem.slider("value",c["default"]||_.max(b))})},b.SelectNode=function(b,c,d,e){var f=this;d=_.extend({label:"Drilldowns",nullable:!1,options:"dimensions",single:!1},d);var g=d.single?"":[""],h=d["default"]||g,i=_.sortBy(_.values(e[d.options]),function(a){return a.label});f.nodeTemplate=Handlebars.compile("         <div class='{{obj.type}} control-group' id='{{obj.id}}'>             <label for='{{obj.id}}' class='control-label'>{{obj.label}}</label>             <div class='controls'>                 <a class='add-level btn btn-small' href='#'><i class='icon-plus-sign'></i>                 Add a level</a>                 {{#obj.help}}<p class='help-block'>{{this}}</p>{{/obj.help}}             </div>         </div>"),f.levelTemplate=Handlebars.compile("         <div class='level'>             <select class='drilldown'>                 {{#obj.nullable}}                     <option value=''>(no selection)</option>                 {{/obj.nullable}}                 {{#options}}                     <option value='{{name}}'>{{label}}</option>                 {{/options}}             </select>             <a class='remove-level' href='#'><i class='icon-minus-sign'></i></a>         </div>         "),f.serialize=function(){var b=[];return f.nodeElem.find(".drilldown").each(function(c,d){b.push(a(d).val())}),d.single?b[0]:b},f.addLevel=function(){var a=f.levelTemplate({options:i,obj:d});f.nodeElem.find(".add-level").before(a);var b=f.nodeElem.find(".level").last();return d.single?b.find(".remove-level").remove():b.find(".remove-level").click(f.removeLevel),!1},f.removeLevel=function(b){return a(b.target).parents(".level").remove(),c.trigger("change"),!1},c.append(f.nodeTemplate({obj:d})),f.nodeElem=c.find("#"+d.id),d.single?(f.addLevel(),f.nodeElem.find(".drilldown").val(d["default"]),f.nodeElem.find(".add-level").remove()):(_.each(h,function(a){f.addLevel();var b=f.nodeElem.find(".level").last();b.find(".drilldown").val(a)}),f.nodeElem.find(".add-level").click(f.addLevel))},b.CutsNode=function(b,c,d,e){var f=this;f.filterTemplate=Handlebars.compile("         <div class='filter'>             <select class='dimension'>                 {{#dimensions}}                     <option value='{{name}}'>{{label}}</option>                 {{/dimensions}}             </select>             <select class='attribute'></select>             <input class='value' />             <a class='remove-filter' href='#'><i class='icon-minus-sign'></i></a>         </div>         "),f.nodeTemplate=Handlebars.compile("         <div class='{{obj.type}} control-group' id='{{obj.id}}'>             <label for='{{obj.id}}' class='control-label'>{{obj.label}}</label>             <div class='controls'>                 <a class='add-filter btn btn-small' href='#'><i class='icon-plus-sign'></i> Add a filter</a>                 {{#obj.help}}<p class='help-block'>{{this}}</p>{{/obj.help}}             </div>         </div>"),f.serialize=function(){var b={};return f.nodeElem.find(".filter").each(function(c,d){var e=a(d),f=e.find(".dimension").val(),g=e.find(".attribute").val(),h=e.find(".value").val();g&&(f=f+"."+g),b[f]=b[f]?[h].concat(b[f]):h}),b},d=_.extend({label:"Filters"},d);var g=d["default"]||{},h=_.sortBy(_.values(e.dimensions),function(a){return a.label});f.autoComplete=function(a,c){return function(d,e){b.fetchDistinct(a,c,d.term).then(function(a){e(_.map(a.results,function(a){return c?a[c]:a}))})}},f.setFilter=function(a,d,g,h){var i=a.find(".dimension"),j=a.find(".attribute"),k=a.find(".value").hide();d=i.val(d).val();var l=e.dimensions[d];j.empty(),l.attributes?(_.each(_.keys(l.attributes),function(a){j.append("<option name='"+a+"'>"+a+"</option>")}),g=j.val(g||"label").val(),j.show()):(j.val(""),j.hide()),b.fetchDistinct(d,g).then(function(b){b.count>20?(k.replaceWith("<input class='value' />"),k=a.find(".value"),k.autocomplete({source:f.autoComplete(d,g),select:function(){k.trigger("change")}})):(k.replaceWith("<select class='value' />"),k=a.find(".value"),_.each(b.results,function(a){"string"!=typeof a&&g&&(a=a[g]),k.append('<option value="'+a+'">'+a+"</option>")})),k.val(h),c.trigger("change")})},f.dimensionChange=function(b){var c=a(b.target).parents(".filter");return f.setFilter(c,c.find(".dimension").val()),!1},f.attributeChange=function(b){var c=a(b.target).parents(".filter");return f.setFilter(c,c.find(".dimension").val(),c.find(".attribute").val()),!1},f.addFilter=function(a,b,c,d){var e=f.filterTemplate({dimensions:h});f.nodeElem.find(".add-filter").before(e);var g=f.nodeElem.find(".filter").last();return g.find(".remove-filter").click(f.removeFilter),g.find(".dimension").change(f.dimensionChange),g.find(".attribute").change(f.attributeChange),f.setFilter(g,b,c,d),!1},f.removeFilter=function(b){return a(b.target).parents(".filter").remove(),c.trigger("change"),!1},c.append(f.nodeTemplate({obj:d})),f.nodeElem=c.find("#"+d.id),_.each(_.keys(g),function(a){var b=a.split(".")[0],c=a.split(".")[1];f.addFilter(null,b,c,g[a])}),f.nodeElem.find(".add-filter").click(f.addFilter)},b.QueryNodes={select:b.SelectNode,cuts:b.CutsNode,slider:b.SliderNode}}(jQuery);var OpenSpending=OpenSpending||{};OpenSpending.Widgets=OpenSpending.Widgets||{},function($){var osw=OpenSpending.Widgets;osw.embedCode="<iframe width='<%= w %>' height='<%= h %>' src='<%= url %>' frameborder='0'></iframe>",osw.Chooser=function(a,b,c){var d=this;this.$e=a,this.widgets=b,this.callback=c,OpenSpending.addWidgetMetadata=function(a,b){d.widgets[a]=_.extend(d.widgets[a],b);var c=d.widget_template(d.widgets[a]);d.$e.find("#widgets-select-list").append(c),d.$e.find("#select-"+a).click(function(){d.callback(d.widgets[a])})},this.render=function(){d.$e.html(d.list_template);for(var a in this.widgets)$.ajax({cache:!0,url:this.widgets[a].base+"/metadata.json",dataType:"jsonp"})},this.widget_template=Handlebars.compile("         <tr>             <td class='preview'>                 <img src='{{preview}}' />             </td>             <td class='desc'>                 <h3>{{title}}</h3>                 <p>{{description}}</p>             </td>             <td>                 <a class='btn' id='select-{{name}}' href='#configure'><i class='icon-arrow-right'></i></a>             </td>         </tr>     "),this.list_template="         <div class='row'>             <div class='span8'>                 <table id='widgets-select-list' class=table'>                 </table>             </div>         </div>     "},osw.Use=function(a,b,c,d){var e=this;this.render=function(){a.append(this.template),e.$e=$("#embedder"),e.$e.find("form").change(this.updateEmbed),e.$f=$("#save-view"),e.$f.submit(this.saveView),this.updateEmbed()},this.saveView=function(){return e.$f.find("#field-label").val().length?(e.$f.find("#field-widget").val(d),e.$f.find("#field-state").val(JSON.stringify(c.serialize())),void 0):(e.$f.find("#field-label").parents(".control-group").addClass("error"),!1)},this.updateEmbed=function(){var a={w:e.$e.find("#width").val(),h:e.$e.find("#height").val()},f=b.siteUrl+"/"+b.dataset+"/embed";f=f+"?widget="+encodeURIComponent(d),f=f+"&state="+encodeURIComponent(JSON.stringify(c.serialize())),f=f+"&width="+a.w,f=f+"&height="+a.h,a.url=f,e.$e.find("#embedcode").val(_.template(osw.embedCode,a))},this.template=$("#widget-finalize").html()},osw.Editor=function(options){var self=this;self.options=options,self.clear=function(){self.options.elem.empty(),self.options.elem.append('<div id="editor-inner"></div>'),self.elem=self.options.elem.find("#editor-inner")},self.choose=function(){self.clear(),self.chooser=new osw.Chooser(self.elem,self.options.widgets,function(a){self.widget_metadata=a,self.configure()}),self.chooser.render()},self.configure=function(){$.ajax({url:this.widget_metadata.js,cache:!0,dataType:"script"}).done(function(){widget_class=eval(self.widget_metadata.class_name),dfd=new widget_class(self.elem,self.options.context,{}),dfd.done(function(a){self.widget=a,self.widget.configure&&self.widget.configure(self.use)})})},self.use=function(){self.clear(),this.embedder=new osw.Use(self.elem,self.options.context,self.widget,self.widget_metadata.name),this.embedder.render()},self.choose()},osw.Embedder=function(a,b,c){var d=this;this.template="         <div class='modal hide fade' id='embedder'>             <div class='modal-header'>                 <a class='close' data-dismiss='modal'>×</a>                 <h3>Embed this visualization.</h3>             </div>             <div class='modal-body'>                 <form class='form-horizontal'>                 <div class='row'>                     <p class='help-block span7'>You can copy and paste the embed code into                     a CMS or blog software that supports raw HTML.<br/><br/></p>                 </div>                 <div class='row'>                     <div class='span3'>                         <div class='control-group'>                             <label class='control-label' for='width'>Width:</label>                             <div class='controls'><input id='width' class='span1' value='700'></div>                         </div>                         <div class='control-group'>                             <label class='control-label' for='height'>Height:</label>                             <div class='controls'><input id='height' class='span1' value='400'></div>                         </div>                     </div>                     <div class='span3'>                         <textarea id='embedcode' class='xlarge' rows='4'></textarea>                     </div>                 </div>                 </form>             </div>         </div>",this.render=function(){$("#embedder").length||($("body").append(this.template),d.$e=$("#embedder")),d.$e.modal(),d.$e.find("form").change(this.updateEmbed),this.updateEmbed()
},this.updateEmbed=function(){var e={w:d.$e.find("#width").val(),h:d.$e.find("#height").val()},f=b.siteUrl+"/"+b.dataset+"/embed";f=f+"?widget="+encodeURIComponent(c),f=f+"&state="+encodeURIComponent(JSON.stringify(a.serialize())),f=f+"&width="+e.w,f=f+"&height="+e.h,e.url=f,d.$e.find("#embedcode").val(_.template(osw.embedCode,e))}}}(jQuery),OpenSpending="OpenSpending"in window?OpenSpending:{},function(a){OpenSpending.Treemap=function(b,c,d){var e=this,f=[OpenSpending.scriptRoot+"/widgets/treemap/js/thejit-2.min.js",OpenSpending.scriptRoot+"/widgets/treemap/css/treemap.css"];window.HTMLCanvasElement||f.push(OpenSpending.scriptRoot+"/widgets/treemap/js/excanvas.js"),e.context=a.extend({click:function(a){if(a.data.link){var b=c.embed?a.data.link+"?embed=true":a.data.link;document.location.href=b}},hasClick:function(a){return void 0!==a.data.link},createLabel:function(a,b,c){c.data.value/e.total>.03&&(b.innerHTML="<div class='desc'><div class='amount'>"+OpenSpending.Utils.formatAmountWithCommas(c.data.value,0,e.currency)+"</div><div class='lbl'>"+c.name+"</div></div>")},tooltipMessage:function(a,b){var c=100*b.data.value/a.total;return b.name+" ("+OpenSpending.Utils.formatAmountWithCommas(c,2)+"%)"},drilldown:function(a){e.drilldown(a)}},c),e.state=d,this.configure=function(a){e.$qb.empty(),new OpenSpending.Widgets.QueryBuilder(e.$qb,e.update,a,e.context,[{variable:"drilldowns",label:"Tiles:",type:"select","default":e.state.drilldowns,help:"Each selected dimension will display as an additional level of tiles for the treemap."},{variable:"year",label:"Year:",type:"slider",dimension:"time",attribute:"year","default":e.state.year,help:"Filter by year."},{variable:"cuts",label:"Filters:",type:"cuts","default":e.state.cuts,help:"Limit the set of data to display."}])},this.update=function(a){e.state=a,e.state.drilldowns=e.state.drilldowns||[e.state.drilldown],e.state.cuts=e.state.cuts||{};var b=[];for(var c in e.state.cuts)b.push(c+":"+e.state.cuts[c]);e.state.year&&b.push("time.year:"+e.state.year),"undefined"!=typeof e.context.member&&"undefined"!=typeof e.context.dimension&&b.push(e.context.dimension+":"+e.context.member),e.state.drilldowns&&(e.aggregator=new OpenSpending.Aggregator({siteUrl:e.context.siteUrl,dataset:e.context.dataset,drilldowns:e.state.drilldowns,cuts:b,rootNodeLabel:"Total",callback:function(a){e.setDataFromAggregator(this.dataset,a)}}))},this.getDownloadURL=function(){return e.aggregator.getCSVURL()},this.serialize=function(){return e.state},this.init=function(){e.$e=b,e.$e.before('<div class="treemap-qb"></div>'),e.$qb=b.prev(),e.$e.addClass("treemap-widget"),e.update(d)},this.setDataFromAggregator=function(a,b){e.currency=b.currency,e.setNode(b)},this.setNode=function(b){var c=!0;e.total=b.amount,e.data={children:a.map(b.children,function(a){return a.color&&(c=!1),{children:[],id:a.id,name:a.label||a.name,data:{node:a,value:a.amount,$area:a.amount,title:a.label||a.name,link:a.html_url,name:a.name,$color:a.color||"#333333"}}})},c&&this.autoColorize(),e.draw()},this.drilldown=function(a){a.data.node.children.length?e.setNode(a.data.node):e.context.click(a)},this.autoColorize=function(){for(var a=e.data.children.length,b=OpenSpending.Utils.getColorPalette(a),c=0;a>c;c++)e.data.children[c].data.$color=b[c]},this.draw=function(){return e.$e.empty(),e.data.children.length?(a(e.$e).show(),e.tm=new $jit.TM.Squarified({injectInto:e.$e.prop("id"),levelsToShow:1,titleHeight:0,animate:!0,transition:$jit.Trans.Expo.easeOut,offset:2,Label:{type:"HTML",size:12,family:"Tahoma, Verdana, Arial",color:"#DDE7F0"},Node:{color:"#243448",CanvasStyles:{shadowBlur:0,shadowColor:"#000"}},Events:{enable:!0,onClick:function(a){a&&e.context.drilldown(a)},onRightClick:function(){e.tm.out()},onMouseEnter:function(a){a&&(e.context.hasClick(a)||e.$e.find("#"+a.id).css("cursor","default"),a.setCanvasStyle("shadowBlur",8),a.orig_color=a.getData("color"),a.setData("color","#A3B3C7"),e.tm.fx.plotNode(a,e.tm.canvas))},onMouseLeave:function(a){a&&(a.removeData("color"),a.removeCanvasStyle("shadowBlur"),a.setData("color",a.orig_color),e.tm.plot())}},duration:1e3,Tips:{enable:!0,type:"Native",offsetX:20,offsetY:20,onShow:function(a,b){var c='<div class="tip-title">'+e.context.tooltipMessage(e,b)+'</div><div class="tip-text">';b.data,a.innerHTML=c}},request:function(a,b,c){var d=json,e=$jit.json.getSubtree(d,a);$jit.json.prune(e,1),c.onComplete(a,e)},onCreateLabel:function(a,b){e.context.createLabel(e,a,b)}}),e.tm.loadJSON(this.data),e.tm.refresh(),void 0):(a(e.$e).hide(),void 0)};var g=a.Deferred();return g.done(function(a){a.init()}),window.treemapWidgetLoaded?g.resolve(e):yepnope({load:f,complete:function(){window.treemapWidgetLoaded=!0,g.resolve(e)}}),g.promise()}}(jQuery),function(){angular.module("fgvApp").filter("slug",function(){return function(a){var b,c,d,e,f,g,h;if(!a)return"";for(e=a.trim().toLowerCase(),c="àáäâãèéëêìíïîòóöôõùúüûñç·/_,:;",f="aaaaaeeeeiiiiooooouuuunc------",d=g=0,h=c.length;h>g;d=++g)b=c[d],e=e.replace(new RegExp(b,"g"),f.charAt(d));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}})}.call(this),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("fgvApp").directive("treemap",["openspending",function(b){var c,d,e,f;return e=function(a){var b,c,d;for(d=[],b=c=0;a>=0?a>c:c>a;b=a>=0?++c:--c)d.push("#1C2F67");return d},c=function(a,b){return{id:parseInt(b.data.name),label:b.name,taxonomy:b.data.node.taxonomy}},f=function(a,b){var d;return d=a.context.drilldown,a.context.drilldown=function(e){return b.$apply(function(){var f,g,h;return h=b.breadcrumb[b.breadcrumb.length-1],f=c(a,e),g=!h||h.taxonomy!==f.taxonomy,a.context.hasClick(e)&&g&&b.breadcrumb.push(f),d(e)})}},d=function(a,c,d,e,g,h){var i,j,k;return k={drilldowns:c,year:d,cuts:e},i={dataset:b.dataset,siteUrl:b.url,embed:!0,click:function(){},hasClick:g},j=new window.OpenSpending.Treemap(a,i,k),j.done(function(a){return f(a,h)}),j},{restrict:"E",scope:{year:"=",breadcrumb:"=",cuts:"="},templateUrl:"views/partials/treemap.html",link:function(c,f,g){var h,i;return window.OpenSpending.Utils.getColorPalette=e,window.OpenSpending.scriptRoot=""+b.url+"/static/openspendingjs",window.OpenSpending.localeGroupSeparator=",",window.OpenSpending.localeDecimalSeparator=".",h=g.drilldowns.split("|"),i=f.children("div"),c.$watch("cuts",function(b){var e,f,g,j,k,l;return b=c.cuts,l=b.year,k=function(){var c,d,e;for(e=[],c=0,d=h.length;d>c;c++)f=h[c],a.call(Object.keys(b),f)<0&&e.push(f);return e}(),e=[k[0]],l?(j=h[h.length-1],g=function(a){return a.data.node.taxonomy!==j},d(i,e,l,b,g,c)):void 0},!0)}}}])}.call(this);